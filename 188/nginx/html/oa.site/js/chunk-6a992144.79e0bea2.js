(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a992144"],{2476:function(t,a,e){},"2edf":function(t,a,e){"use strict";e.d(a,"a",function(){return n});var r=e("b775");function n(t){return Object(r["b"])({url:"/crmClass",method:"get",params:t})}},"8be3":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-card",{attrs:{bordered:!1}},[e("div",{attrs:{id:"components-form-demo-advanced-search"}},[e("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:t.form},on:{submit:t.handleSearch}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"日期"}},[e("a-range-picker",{on:{change:t.onChange}},[e("template",{slot:"renderExtraFooter"},[t._v("可选区间30天")])],2)],1)],1),e("a-col",{attrs:{span:8}},[e("a-button",{attrs:{type:"primary"},on:{click:function(a){return t.$refs.table.refresh(!0)}}},[t._v("搜索")]),e("a-button",{style:{marginLeft:"8px"},on:{click:function(){return t.queryParam={}}}},[t._v("重置")]),e("a",{style:{marginLeft:"8px",fontSize:"12px"},on:{click:t.toggle}},[t._v("\n            高级搜索\n            "),e("a-icon",{attrs:{type:t.expand?"up":"down"}})],1)],1),e("a-col",{attrs:{span:8}},[e("span",[t._v("默认展示最近7天的数据")])])],1),e("a-row",{style:{display:t.count?"block":"none"},attrs:{gutter:24}},[e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"媒体"}},[e("a-select",{on:{focus:function(a){return t.loadSelectDataCrmClass(21446)}},model:{value:t.queryParam.mediaAccountType,callback:function(a){t.$set(t.queryParam,"mediaAccountType",a)},expression:"queryParam.mediaAccountType"}},t._l(t.CrmClass21446,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.value}},[t._v(t._s(a.name))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"账户"}},[e("a-input",{attrs:{placeholder:"完整名称"},model:{value:t.queryParam.mediaLoginUsername,callback:function(a){t.$set(t.queryParam,"mediaLoginUsername",a)},expression:"queryParam.mediaLoginUsername"}})],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"计划"}},[e("a-input",{attrs:{placeholder:"完整名称"},model:{value:t.queryParam.mediaPlanname,callback:function(a){t.$set(t.queryParam,"mediaPlanname",a)},expression:"queryParam.mediaPlanname"}})],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"推广词"}},[e("a-input",{attrs:{placeholder:"名称模糊搜索"},model:{value:t.queryParam.mediaKeyword,callback:function(a){t.$set(t.queryParam,"mediaKeyword",a)},expression:"queryParam.mediaKeyword"}})],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"平台"}},[e("a-select",{on:{focus:function(a){return t.loadSelectDataCrmClass(20025)}},model:{value:t.queryParam.nexId,callback:function(a){t.$set(t.queryParam,"nexId",a)},expression:"queryParam.nexId"}},t._l(t.CrmClass20025,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.value}},[t._v(t._s(a.name))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"行业"}},[e("a-select",{on:{focus:function(a){return t.loadSelectDataClassTag(1)}},model:{value:t.queryParam.productClassId,callback:function(a){t.$set(t.queryParam,"productClassId",a)},expression:"queryParam.productClassId"}},t._l(t.ClassTag1,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.classTagId}},[t._v(t._s(a.className))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"线索类型"}},[e("a-select",{on:{focus:function(a){return t.loadSelectDataCrmClass(20337)}},model:{value:t.queryParam.mediaAccountShowUse,callback:function(a){t.$set(t.queryParam,"mediaAccountShowUse",a)},expression:"queryParam.mediaAccountShowUse"}},t._l(t.CrmClass20337,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.value}},[t._v(t._s(a.name))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"品牌"}},[e("a-auto-complete",{attrs:{placeholder:"输入品牌名称"},on:{search:t.handleSearchBrand},model:{value:t.queryParam.brand,callback:function(a){t.$set(t.queryParam,"brand",a)},expression:"queryParam.brand"}},[e("template",{slot:"dataSource"},t._l(t.brandSource,function(a){return e("a-select-option",{key:a.brandId+""},[t._v(t._s(a.brandName))])}),1)],2)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"品牌状态"}},[e("a-select",{model:{value:t.queryParam.BrandResult,callback:function(a){t.$set(t.queryParam,"BrandResult",a)},expression:"queryParam.BrandResult"}},t._l(t.BrandResult,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.statusCode}},[t._v(t._s(a.statusName))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"接通状态"}},[e("a-select",{model:{value:t.queryParam.CallResult,callback:function(a){t.$set(t.queryParam,"CallResult",a)},expression:"queryParam.CallResult"}},t._l(t.CallResult,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.statusCode}},[t._v(t._s(a.statusName))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"推荐状态"}},[e("a-select",{model:{value:t.queryParam.RecomendResult,callback:function(a){t.$set(t.queryParam,"RecomendResult",a)},expression:"queryParam.RecomendResult"}},t._l(t.RecomendResult,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.statusCode}},[t._v(t._s(a.statusName))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"地区"}},[e("a-select",{staticStyle:{width:"50%"},on:{focus:function(a){return t.loadSelectDataAreaInfo(0)},change:t.changeAreaInfo},model:{value:t.queryParam.outProvinceId,callback:function(a){t.$set(t.queryParam,"outProvinceId",a)},expression:"queryParam.outProvinceId"}},t._l(t.AreaInfoProvince,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.id}},[t._v(t._s(a.name))])}),1),e("a-select",{style:{width:"50%",display:this.AreaInfoCity&&this.AreaInfoCity.length>0?"inline-block":"none"},model:{value:t.queryParam.outCityId,callback:function(a){t.$set(t.queryParam,"outCityId",a)},expression:"queryParam.outCityId"}},t._l(t.AreaInfoCity,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.id}},[t._v(t._s(a.name))])}),1)],1)],1)],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:12}},[e("v-chart",{attrs:{"force-fit":!0,height:t.height,data:t.chartData,scale:t.scale}},[e("v-tooltip"),e("v-axis"),e("v-legend"),e("v-line",{attrs:{position:"month*temperature",color:"city"}}),e("v-point",{attrs:{position:"month*temperature",color:"city",size:4,"v-style":t.style,shape:"circle"}})],1)],1),e("a-col",{attrs:{span:12}},[e("v-chart",{attrs:{"force-fit":!0,height:t.height,data:t.chartData2,scale:t.scale}},[e("v-tooltip"),e("v-axis",{attrs:{"data-key":"temperature",label:t.labelFormat}}),e("v-legend"),e("v-line",{attrs:{position:"month*temperature",color:"city"}}),e("v-point",{attrs:{position:"month*temperature",color:"city",size:4,"v-style":t.style,shape:"circle"}})],1)],1)],1),e("s-table",{ref:"table",attrs:{columns:t.columns,data:t.loadData,bordered:"",size:"middle",showPagination:!1},scopedSlots:t._u([{key:"notConnectCountRatio",fn:function(a){return e("span",{},[e("ellipsis",{attrs:{length:5,tooltip:""}},[t._v(t._s(a))])],1)}}])})],1)},n=[],o=(e("55dd"),e("a481"),e("28a5"),e("c5f6"),e("2af9")),l=e("b775");function s(t){return Object(l["b"])({url:"/clueouttxid/getdaycount",method:"get",params:t})}function i(t){return Object(l["b"])({url:"/clueStatus",method:"get",params:t})}function u(t){return Object(l["b"])({url:"/areaInfo",method:"get",params:t})}function c(t){return Object(l["b"])({url:"/classTag",method:"get",params:t})}var d=e("2edf"),m=e("9b64"),f=(e("ca00"),e("7104")),h={textStyle:{fill:"#aaaaaa"},formatter:function(t){return t+"%"}},p=[{title:"日期",dataIndex:"dateTime",width:110},{hide:!1,dataIndex:"totalCount",fixed:!1,title:"线索总数",width:80,sortOrder:!0},{hide:!1,dataIndex:"outWay",fixed:!1,title:"有效线索",width:80,sortOrder:!0},{hide:!1,dataIndex:"outWayRatio",fixed:!1,title:"有效线索率",width:0,sortOrder:!0},{hide:!1,dataIndex:"callInfoCount",fixed:!1,title:"通话",width:80,sortOrder:!0},{hide:!1,dataIndex:"callInfoCountRatio",fixed:!1,title:"通话率",width:0,sortOrder:!0},{hide:!1,dataIndex:"callCount",fixed:!1,title:"通话回访线索",sortOrder:!0,children:[{hide:!1,dataIndex:"callNot",fixed:!1,title:"未接通",width:80,sortOrder:!0},{hide:!1,dataIndex:"call",fixed:!1,title:"接通",width:80,sortOrder:!0},{hide:!1,dataIndex:"callRatio",fixed:!1,title:"接通率",width:80,sortOrder:!0},{hide:!1,dataIndex:"brandNot",fixed:!1,title:"错误品牌",width:80,sortOrder:!0},{hide:!1,dataIndex:"brand",fixed:!1,title:"正确品牌",width:80,sortOrder:!0},{hide:!1,dataIndex:"brandRatio",fixed:!1,title:"正确品牌率",width:80,sortOrder:!0},{hide:!1,dataIndex:"recomendNot",fixed:!1,title:"不推荐",width:80,sortOrder:!0},{hide:!1,dataIndex:"recomend",fixed:!1,title:"推荐",width:80,sortOrder:!0},{hide:!1,dataIndex:"recomendRatio",fixed:!1,title:"推荐率",width:80,sortOrder:!0}]}],y={name:"clue-out-txid-list",components:{STable:o["q"],Ellipsis:o["g"]},data:function(){var t=this;return{expand:!1,form:this.$form.createForm(this),brandSource:[],chartData:[],chartData2:[],labelFormat:h,scale:[{dataKey:"month",min:0,max:1}],height:400,style:{stroke:"#fff",lineWidth:1},queryParam:{},columns:p,loadData:function(a){if(t.queryParam.outCityId&&(t.queryParam.outCityId=t.AreaInfoCity&&t.AreaInfoCity.length>0&&t.AreaInfoCity.filter(function(a){return a.id==t.queryParam.outCityId}).length>0?t.queryParam.outCityId:""),!t.queryParam.brand||Number(t.queryParam.brand))return s(Object.assign(a,t.queryParam)).then(function(a){for(var e=[],r=[],n=0;n<a.data.length;n++){var o=a.data[n];o.dateTime=(o.clueYear+"-"+o.clueMonth+"-"+o.clueDay).split("-").map(function(t){return t.length<=1?"0".concat(t):t}).join("-"),o.callNot=o.callInfoCount-o.call,o.brandNot=o.callInfoCount-o.brand,o.recomendNot=o.callInfoCount-o.recomend,o.outWayRatio=(o.outWay/o.totalCount*100).toFixed(2)+"%",o.callInfoCountRatio=(o.callInfoCount/o.totalCount*100).toFixed(2)+"%",o.callRatio=(o.call/o.callInfoCount*100).toFixed(2)+"%",o.brandRatio=(o.brand/o.callInfoCount*100).toFixed(2)+"%",o.recomendRatio=(o.recomend/o.callInfoCount*100).toFixed(2)+"%";o.dateTime.replace(/-/g,"");e.push({month:o.dateTime.substr(5),"线索总数":o.totalCount,"有效线索":o.outWay,"回访数量":o.callInfoCount}),r.push({month:o.dateTime.substr(5),"有效率":parseFloat(o.outWayRatio),"回访率":parseFloat(o.callInfoCountRatio),"接通率":parseFloat(o.callRatio),"品牌正确率":parseFloat(o.brandRatio),"推荐率":parseFloat(o.recomendRatio)})}var l=(new f.View).source(e.reverse());l.transform({type:"fold",fields:["线索总数","有效线索","回访数量"],key:"city",value:"temperature"}),t.chartData=l.rows;var s=(new f.View).source(r.reverse());return s.transform({type:"fold",fields:["有效率","回访率","接通率","品牌正确率","推荐率"],key:"city",value:"temperature"}),t.chartData2=s.rows,a}).catch(function(t){console.log(t)});t.$notification.info({message:"提示",description:"请选择一个品牌"})},BrandResult:[],CallResult:[],RecomendResult:[],CrmClass21446:[],CrmClass20025:[],CrmClass20337:[],ClassTag1:[],AreaInfoProvince:[],AreaInfoCity:[]}},created:function(){this.getClueStatusList()},computed:{count:function(){return this.expand}},methods:{getClueStatusList:function(){var t=this;i({PageNo:1,PageSize:1e3}).then(function(a){t.BrandResult=a.data.filter(function(t){return 1050===t.parentId}).sort(function(t){return function(a,e){return a[t].localeCompare(e[t],"zh-CN")}}("statusName")),t.CallResult=a.data.filter(function(t){return 1035===t.parentId}).sort(function(t){return function(a,e){return a[t].localeCompare(e[t],"zh-CN")}}("statusName")),t.RecomendResult=a.data.filter(function(t){return 1064===t.parentId}).sort(function(t){return function(a,e){return a[t].localeCompare(e[t],"zh-CN")}}("statusName"))})},handleSearch:function(t){t.preventDefault(),this.form.validateFields(function(t,a){console.log("error",t),console.log("Received values of form: ",a)})},handleReset:function(){window.location.href=window.location.href,this.form.table.resetFields()},onChange:function(t,a){a&&(this.queryParam.clueTime=a.join(","),","!=this.queryParam.clueTime)||delete this.queryParam.clueTime},toggle:function(){this.expand=!this.expand},handleChange:function(t){console.log("selected ".concat(t))},loadSelectDataCrmClass:function(t){var a=this;0==this["CrmClass"+t].length&&Object(d["a"])({ParentId:t}).then(function(e){e.data&&e.data.length>0&&(a["CrmClass"+t]=e.data)})},loadSelectDataClassTag:function(t){var a=this;0==this["ClassTag"+t].length&&c({FatherTagId:t}).then(function(e){e.data&&e.data.length>0&&(a["ClassTag"+t]=e.data)})},loadSelectDataAreaInfo:function(t){var a=this;(0===t&&0==this.AreaInfoProvince.length||t>0)&&u({ParentId:t}).then(function(e){0===t?a.AreaInfoProvince=e.data:a.AreaInfoCity=e.data})},changeAreaInfo:function(t){this.loadSelectDataAreaInfo(t)},handleSearchBrand:function(t){var a=this,e=/[\u4E00-\u9FA5\uF900-\uFA2D]/,r=/[0-9]/;(e.test(t)||r.test(t))&&(t=t.replace(/[0-9]/g,"").replace("[]",""),Object(m["a"])({BrandName:t}).then(function(t){a.brandSource=t.data.map(function(t){return{brandId:t.brandId,brandName:"["+t.brandId+"]"+t.brandName}})}))}}},b=y,v=(e("99bb"),e("2877")),C=Object(v["a"])(b,r,n,!1,null,null,null);a["default"]=C.exports},"99bb":function(t,a,e){"use strict";var r=e("2476"),n=e.n(r);n.a},"9b64":function(t,a,e){"use strict";e.d(a,"a",function(){return n});var r=e("b775");function n(t){return Object(r["b"])({url:"/brandindex",method:"get",params:t})}}}]);