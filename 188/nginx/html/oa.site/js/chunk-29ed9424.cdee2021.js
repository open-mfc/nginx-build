(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29ed9424"],{"2edf":function(t,a,e){"use strict";e.d(a,"a",function(){return n});var r=e("b775");function n(t){return Object(r["b"])({url:"/crmClass",method:"get",params:t})}},"414e":function(t,a,e){"use strict";var r=e("da0a"),n=e.n(r);n.a},"4bed":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-card",{attrs:{bordered:!1}},[e("div",{attrs:{id:"components-form-demo-advanced-search"}},[e("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:t.form},on:{submit:t.handleSearch}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"日期"}},[e("a-range-picker",{on:{change:t.onChange}},[e("template",{slot:"renderExtraFooter"},[t._v("可选区间30天")])],2)],1)],1),e("a-col",{attrs:{span:8}},[e("a-button",{attrs:{type:"primary"},on:{click:function(a){return t.$refs.table.refresh(!0)}}},[t._v("搜索")]),e("a-button",{style:{marginLeft:"8px"},on:{click:function(){return t.queryParam={}}}},[t._v("重置")]),e("a",{style:{marginLeft:"8px",fontSize:"12px"},on:{click:t.toggle}},[t._v("\n            高级搜索\n            "),e("a-icon",{attrs:{type:t.expand?"up":"down"}})],1)],1),e("a-col",{attrs:{span:8}},[e("span",[t._v("默认展示最近7天的数据")])])],1),e("a-row",{style:{display:t.count?"block":"none"},attrs:{gutter:24}},[e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"平台"}},[e("a-select",{on:{focus:function(a){return t.loadSelectDataCrmClass(20025)}},model:{value:t.queryParam.nexId,callback:function(a){t.$set(t.queryParam,"nexId",a)},expression:"queryParam.nexId"}},t._l(t.CrmClass20025,function(a){return e("a-select-option",{key:a.key,attrs:{value:a.value}},[t._v(t._s(a.name))])}),1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"品牌"}},[e("a-auto-complete",{attrs:{placeholder:"输入品牌名称"},on:{search:t.handleSearchBrand},model:{value:t.queryParam.brand,callback:function(a){t.$set(t.queryParam,"brand",a)},expression:"queryParam.brand"}},[e("template",{slot:"dataSource"},t._l(t.brandSource,function(a){return e("a-select-option",{key:a.brandId+""},[t._v(t._s(a.brandName))])}),1)],2)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-item",{attrs:{label:"来源"}},[e("a-select",{attrs:{defaultValue:"0"},model:{value:t.queryParam.talkType,callback:function(a){t.$set(t.queryParam,"talkType",a)},expression:"queryParam.talkType"}},[e("a-select-option",{attrs:{value:"0"}},[t._v("全部")]),e("a-select-option",{attrs:{value:"1"}},[t._v("易聊")]),e("a-select-option",{attrs:{value:"2"}},[t._v("53客服")])],1)],1)],1)],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:12}},[e("v-chart",{attrs:{"force-fit":!0,height:t.height,data:t.chartData,scale:t.scale}},[e("v-tooltip"),e("v-axis"),e("v-legend"),e("v-line",{attrs:{position:"month*temperature",color:"city"}}),e("v-point",{attrs:{position:"month*temperature",color:"city",size:4,"v-style":t.style,shape:"circle"}})],1)],1),e("a-col",{attrs:{span:12}},[e("v-chart",{attrs:{"force-fit":!0,height:t.height,data:t.chartData2,scale:t.scale}},[e("v-tooltip"),e("v-axis",{attrs:{"data-key":"temperature",label:t.labelFormat}}),e("v-legend"),e("v-line",{attrs:{position:"month*temperature",color:"city"}}),e("v-point",{attrs:{position:"month*temperature",color:"city",size:4,"v-style":t.style,shape:"circle"}})],1)],1)],1),e("s-table",{ref:"table",attrs:{columns:t.columns,data:t.loadData,bordered:"",size:"middle",showPagination:!1},scopedSlots:t._u([{key:"notConnectCountRatio",fn:function(a){return e("span",{},[e("ellipsis",{attrs:{length:5,tooltip:""}},[t._v(t._s(a))])],1)}}])})],1)},n=[],o=(e("a481"),e("c5f6"),e("2af9")),s=e("b775");function l(t){return Object(s["b"])({url:"/TalkIndex/getdaycount",method:"get",params:t})}function c(t){return Object(s["b"])({url:"/TalkIndex/Colunms",method:"get",params:t})}var i=e("2edf"),u=e("9b64"),d=e("7104"),m={textStyle:{fill:"#aaaaaa"},formatter:function(t){return t+"%"}},f={name:"clue-out-txid-list",components:{STable:o["q"],Ellipsis:o["g"]},data:function(){var t=this;return{expand:!1,form:this.$form.createForm(this),brandSource:[],chartData:[],chartData2:[],labelFormat:m,scale:[{dataKey:"month",min:0,max:1}],height:400,style:{stroke:"#fff",lineWidth:1},queryParam:{},columns:[],loadData:function(a){if(!t.queryParam.brand||Number(t.queryParam.brand))return l(Object.assign(a,t.queryParam)).then(function(a){for(var e=[],r=[],n=0;n<a.data.length;n++){var o=a.data[n];e.push({month:o.clueTime.substr(5),"网站流量":o.pv,"访客数":o.totalCount,"有效咨询":o.msgCount,"线索数":o.clueCount}),r.push({month:o.clueTime.substr(5),"有效咨询率":parseFloat(o.msgCountRatio.replace("%","")),"咨询转化率":parseFloat(o.clueMsgRatio.replace("%","")),"访客转化率":parseFloat(o.clueTalkRatio.replace("%",""))})}var s=(new d.View).source(e.reverse());s.transform({type:"fold",fields:["网站流量","访客数","有效咨询","线索数"],key:"city",value:"temperature"}),t.chartData=s.rows;var l=(new d.View).source(r.reverse());return l.transform({type:"fold",fields:["有效咨询率","咨询转化率","访客转化率"],key:"city",value:"temperature"}),t.chartData2=l.rows,console.log(a),a});t.$notification.info({message:"提示",description:"请选择一个品牌"})},CrmClass20025:[]}},created:function(){var t=this;c().then(function(a){a.success&&(t.columns=a.data)})},computed:{count:function(){return this.expand}},methods:{handleSearch:function(t){t.preventDefault(),this.form.validateFields(function(t,a){console.log("error",t),console.log("Received values of form: ",a)})},handleReset:function(){window.location.href=window.location.href,this.form.table.resetFields()},onChange:function(t,a){a&&(this.queryParam.clueTime=a.join(","),","!=this.queryParam.clueTime)||delete this.queryParam.clueTime},toggle:function(){this.expand=!this.expand},handleChange:function(t){console.log("selected ".concat(t))},loadSelectDataCrmClass:function(t){var a=this;0==this["CrmClass"+t].length&&Object(i["a"])({ParentId:t}).then(function(e){e.data&&e.data.length>0&&(a["CrmClass"+t]=e.data)})},handleSearchBrand:function(t){var a=this,e=/[\u4E00-\u9FA5\uF900-\uFA2D]/,r=/[0-9]/;(e.test(t)||r.test(t))&&(e.test(t)&&(t=t.replace(/[0-9]/g,"").replace("[]","")),Object(u["a"])({BrandName:t}).then(function(t){a.brandSource=t.data.map(function(t){return{brandId:t.brandId,brandName:"["+t.brandId+"]"+t.brandName}})}))}}},p=f,h=(e("414e"),e("2877")),b=Object(h["a"])(p,r,n,!1,null,null,null);a["default"]=b.exports},"9b64":function(t,a,e){"use strict";e.d(a,"a",function(){return n});var r=e("b775");function n(t){return Object(r["b"])({url:"/brandindex",method:"get",params:t})}},da0a:function(t,a,e){}}]);